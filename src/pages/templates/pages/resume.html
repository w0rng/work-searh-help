{% extends "../base.html" %}
{% load bootstrap4 %}
{% block title %}
    Резюме
{% endblock title %}
{% block content %}


<div>

    <div style="text-align: center;">
        {% if user.role == "worker" %}
            {% if not request.user.has_resume %}
                <h2>Ухты пухты! У тебя еще нет резюме</h2>
            {% else %}
                <h2>Редактирование резюме</h2>
            {% endif %}
        {% else %}
            {% if user.vacancy.count == 0 %}
                <h2>Ох, а как без вакансии искать работников</h2>
            {% else %}
                <h2>Список соискателей</h2>
            {% endif %}
        {% endif %}
    </div>

    {% if user.role == "worker" %}
        <form action="" method="post" class="form container">
            {% csrf_token %}
            {% bootstrap_form form %}
            {% buttons %}
                {% if not request.user.has_resume %}
                    <button type="submit" class="btn btn-primary">Создать</button>
                {% else %}
                    <button type="submit" class="btn btn-primary">Сохранить</button>
                {% endif %}
            {% endbuttons %}
        </form>
    {% else %}
        {% if user.vacancy.count == 0 %}
            <form action="" method="post" class="form container">
                {% csrf_token %}
                {% bootstrap_form form %}
                {% buttons %}
                    <button type="submit" class="btn btn-primary">Создать</button>
                {% endbuttons %}
            </form>
        {% else %}
            <ul class="pagination justify-content-center">
                {% for num in count_pages %}
                {% ifequal num page_obj.number %}
                <li class="page-item active">
                    <a class="page-link" href="#">{{ num }}</a>
                </li>
                {% else %}
                <li class="page-item"><a class="page-link" href="?page={{ num }}">{{ num }}</a></li>
                {% endifequal %}
                {% endfor %}
            </ul>
            <div class="row">
                {% for resume in object_list %}
                    <div class="modal fade bd-example-modal-lg" id="resume_{{ resume.pk }}" tabindex="-1" role="dialog"
                         aria-hidden="true">
                        <div class="modal-dialog modal-lg">
                            <div class="modal-content">
                                <div class="modal-header">
                                    <h5 class="modal-title" id="exampleModalLabel">{{ resume.name }}</h5>
                                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                        <span aria-hidden="true">&times;</span>
                                    </button>
                                </div>
                                <div class="modal-body">
                                    {% if resume.fio == None %}
                                        Зовут {{ resume.user.first_name }} {{ resume.user.last_name }}.
                                    {% else %}
                                        Зовут {{ resume.fio }}.
                                    {% endif %}
                                    Живет в {{ resume.city }}. <br>
                                    Притендует на должность "{{ resume.name }}" и хочет {{ resume.price }} денег. <br>
                                    {% if resume.remote %}
                                        Может работать удаленно <br>
                                    {% endif %}
                                    Навыки: {% for tag in resume.tags.all %} <span class="badge badge-{{ random_colors|random }}">{{ tag.name }}</span> {% endfor %}. <br>
                                </div>

                                <div class="modal-footer">
                                    <button type="submit" class="btn btn-success">Пригласить на собеседование</button>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-sm-4" style="margin-bottom: 30px;">
                        <div class="card">
                            <div class="card-body">
                                <h5 class="card-title">{{ resume.name }}</h5>
                                <p class="card-text">{{ resume.price }} руб.</p>
                                <button type="button" class="btn btn-primary" data-toggle="modal"
                                        data-target="#resume_{{ resume.pk }}">
                                    Подробнее
                                </button>
                            </div>
                        </div>
                    </div>
                {% endfor %}
            </div>
            <ul class="pagination justify-content-center">
                {% for num in count_pages %}
                {% ifequal num page_obj.number %}
                <li class="page-item active">
                    <a class="page-link" href="#">{{ num }}</a>
                </li>
                {% else %}
                <li class="page-item"><a class="page-link" href="?page={{ num }}">{{ num }}</a></li>
                {% endifequal %}
                {% endfor %}
            </ul>
        {% endif %}
    {% endif %}
</div>
{% endblock content %}